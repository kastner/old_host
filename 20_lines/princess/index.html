<html>
  <body onload="draw();">
    <style>
      body {
      	background: black;
      	color: white;
      }
      #info {
      	width: 300px;
      	justify;
      }
      #board {
      	margin-top:10px;
      	position: relative;
      	background: url("bg.jpg");
      	width: 240px;
      	height: 180px;
      	/*
      	border: 1px solid black;
      	*/
      }
      #c_4 {
      	position: relative;
      }
      #debug {
      margin-top: 20px;
      }
    </style>
    <div id="board">&nbsp;</div>
    <p id="info">
      Mario, the princess has been cloned and scattered all around. Please save
      her with the help of your brother,
      <img src="4.gif" height="20" width="20" />!<br />
      Only you can move, but you can switch places with your brother by hitting
      the space bar.<br />
      Here in the ice world, once you start moving in a direction (with your
      arrow keys), you can't stop until you hit something solid (like a wall, or
      your brother!).<br />
      If you get stuck, just hit "R" and everything will go back to how it
      was!<br /><br />
      <strong>current level:</strong> <span id="xlevel"></span>
    </p>
    <div id="debug">
      <br />
    </div>
    <script langauge="javascript">
      /* TODO
1. make animation better on moving the hero (smother, slower)
2. show move count - and impose limit (1024 for 10 levels)
*/
      /*
				//Blank Board
				0,0,0,0,0,0,0,0,0,0,0,0,
				0,1,1,1,1,1,1,1,1,1,1,0,
				0,1,1,1,1,1,1,1,1,1,1,0,
				0,1,1,1,1,1,1,1,1,1,1,0,
				0,1,1,1,1,1,1,1,1,1,1,0,
				0,1,1,1,1,1,1,1,1,1,1,0,
				0,1,1,1,1,1,1,1,1,1,1,0,
				0,1,1,1,1,1,1,1,1,1,1,0,
				0,0,0,0,0,0,0,0,0,0,0,0
*/
      // p01s trick - thanks
      /* 01 */ var board = [
        0 +
          0 * (moves = 0) +
          0 * (level = 1) +
          0 * (width = 12) +
          0 * (height = 9) +
          0 * (reset = []),
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        1,
        0,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        0,
        0,
        0,
        1,
        0,
        1,
        1,
        1,
        1,
        1,
        2,
        1,
        0,
        0,
        0,
        1,
        0,
        0,
        1,
        1,
        2,
        1,
        1,
        1,
        1,
        0,
        0,
        1,
        1,
        0,
        2,
        1,
        1,
        1,
        1,
        1,
        1,
        0,
        0,
        1,
        1,
        0,
        1,
        1,
        1,
        0,
        0,
        0,
        1,
        0,
        0,
        2,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        0,
        0,
        1,
        1,
        1,
        3,
        1,
        4,
        1,
        1,
        2,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,

        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        0,
        2,
        0,
        0,
        1,
        1,
        1,
        1,
        2,
        1,
        1,
        1,
        1,
        1,
        0,
        0,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        0,
        0,
        0,
        2,
        0,
        1,
        0,
        1,
        1,
        0,
        1,
        0,
        0,
        0,
        1,
        0,
        2,
        0,
        1,
        1,
        0,
        2,
        0,
        1,
        0,
        0,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        0,
        0,
        1,
        1,
        0,
        3,
        1,
        4,
        1,
        0,
        1,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,

        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        0,
        1,
        0,
        0,
        1,
        1,
        0,
        0,
        1,
        1,
        1,
        0,
        0,
        1,
        0,
        0,
        1,
        2,
        0,
        2,
        1,
        1,
        1,
        1,
        1,
        1,
        0,
        0,
        1,
        1,
        1,
        1,
        1,
        0,
        0,
        1,
        1,
        1,
        0,
        0,
        1,
        1,
        1,
        1,
        1,
        2,
        0,
        1,
        2,
        1,
        0,
        0,
        1,
        0,
        2,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        0,
        0,
        1,
        0,
        0,
        3,
        0,
        4,
        1,
        1,
        1,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,

        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        0,
        0,
        0,
        1,
        1,
        1,
        0,
        2,
        1,
        1,
        1,
        1,
        0,
        0,
        1,
        1,
        1,
        0,
        0,
        0,
        1,
        1,
        1,
        1,
        0,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        1,
        0,
        2,
        1,
        0,
        0,
        0,
        0,
        0,
        1,
        1,
        1,
        0,
        0,
        0,
        1,
        0,
        0,
        1,
        0,
        2,
        1,
        1,
        1,
        1,
        0,
        2,
        1,
        0,
        0,
        1,
        1,
        1,
        3,
        1,
        4,
        1,
        1,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,

        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        0,
        0,
        0,
        0,
        1,
        1,
        0,
        2,
        0,
        1,
        1,
        1,
        0,
        0,
        0,
        1,
        1,
        1,
        2,
        0,
        2,
        1,
        1,
        1,
        0,
        0,
        1,
        1,
        1,
        1,
        0,
        2,
        0,
        2,
        1,
        1,
        0,
        0,
        1,
        1,
        1,
        0,
        1,
        1,
        1,
        0,
        1,
        1,
        0,
        0,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        0,
        0,
        0,
        1,
        1,
        1,
        3,
        1,
        4,
        1,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,

        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        1,
        1,
        1,
        1,
        1,
        0,
        0,
        1,
        1,
        1,
        0,
        0,
        1,
        1,
        1,
        1,
        1,
        1,
        0,
        2,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        1,
        2,
        0,
        1,
        1,
        0,
        0,
        1,
        2,
        0,
        2,
        1,
        1,
        0,
        2,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        1,
        1,
        1,
        1,
        1,
        0,
        0,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        0,
        0,
        1,
        1,
        1,
        3,
        1,
        4,
        1,
        1,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,

        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        1,
        1,
        1,
        1,
        1,
        1,
        0,
        0,
        0,
        0,
        0,
        1,
        1,
        1,
        1,
        1,
        1,
        0,
        0,
        0,
        0,
        0,
        2,
        1,
        0,
        2,
        1,
        1,
        1,
        1,
        0,
        0,
        0,
        2,
        1,
        0,
        0,
        0,
        1,
        1,
        2,
        0,
        0,
        0,
        1,
        1,
        1,
        1,
        0,
        1,
        1,
        2,
        0,
        0,
        0,
        0,
        0,
        1,
        1,
        1,
        1,
        1,
        1,
        0,
        0,
        0,
        0,
        0,
        1,
        1,
        1,
        3,
        1,
        4,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,

        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        0,
        0,
        1,
        1,
        0,
        2,
        1,
        1,
        0,
        0,
        1,
        1,
        0,
        0,
        1,
        1,
        0,
        0,
        0,
        1,
        2,
        0,
        2,
        1,
        0,
        0,
        1,
        1,
        1,
        1,
        0,
        1,
        1,
        1,
        1,
        1,
        0,
        0,
        0,
        0,
        0,
        1,
        2,
        1,
        1,
        1,
        1,
        1,
        0,
        0,
        0,
        0,
        2,
        1,
        1,
        0,
        0,
        0,
        1,
        1,
        0,
        0,
        1,
        1,
        1,
        3,
        1,
        4,
        1,
        1,
        1,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,

        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        0,
        0,
        1,
        0,
        0,
        2,
        1,
        1,
        0,
        0,
        1,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        2,
        1,
        1,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        2,
        1,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        1,
        2,
        0,
        1,
        1,
        0,
        0,
        1,
        0,
        0,
        1,
        1,
        0,
        0,
        1,
        1,
        1,
        0,
        0,
        1,
        1,
        1,
        3,
        1,
        4,
        1,
        1,
        1,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,

        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        1,
        0,
        0,
        1,
        1,
        0,
        1,
        1,
        0,
        0,
        1,
        1,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        1,
        2,
        0,
        1,
        1,
        0,
        0,
        1,
        2,
        0,
        2,
        1,
        1,
        0,
        2,
        1,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        1,
        2,
        0,
        1,
        1,
        0,
        0,
        1,
        1,
        0,
        1,
        1,
        0,
        0,
        1,
        1,
        1,
        0,
        0,
        1,
        1,
        1,
        3,
        1,
        4,
        1,
        1,
        1,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
      ];

      /* 02 */ for (var i = 0; i < board.length; reset[i] = board[i++]) {}
      /*    */ function draw() {
        /* 03 */ var str = ""; // I tried to lose this line line by integrating it into the next line, but it died - (i==(level - 1) * width * height) ? str = .... : str+=.... - froze the browser.
        /* 04 */ for (
          var i = (level - 1) * width * height;
          i < (level - 1) * height * width + height * width;
          str +=
            "<img id='c_" +
            board[i] +
            "' src='" +
            board[i] +
            ".gif' height=20 width=20 />" +
            (++i % width == 0 ? "<br />" : "")
        ) {
          /*    */
        }

        /* 05 */ document.getElementById("board").innerHTML = str;
        /* 06 */ document.getElementById("xlevel").innerHTML =
          level + " - " + moves + " move" + (moves == 1 ? "" : "s");
        /*    */ //(((getPos(2) == 0)?((level+1<=5) ? level++ : level = 1) : "") == "") ? draw() : draw(); <---- this crashes my browser.... doesn't matter tho - without reseting the board, they will see the blankness anyway :(...
        /* 07 */ (
          getPos(2) == 0
            ? level + 1 > 10
              ? alert("You've saved the princess!")
              : level++
            : 0
        )
          ? draw()
          : 0;
        /*    */
      }

      /*    */ function getPos(what) {
        /* 08 */ for (
          var i = (level - 1) * width * height;
          i < (level - 1) * height * width + width * height && board[i] != what;
          i++
        ) {
          /*    */
        }
        /* 09 */ return i == (level - 1) * width * height + width * height
          ? 0
          : i;
        /*    */
      }

      /*    */ //debuging
      /*    */ //str2 += "x = " + x + " y = " + y + "  =  " + board[(y*width) + x] + "<br />";
      /*    */ //str2="";
      /*    */ //document.getElementById("debug").innerHTML = str2;

      /*    */ function doHit(d) {
        /*    */ //document.getElementById('c_4').style.top = parseInt(document.getElementById('c_4').style.top) - 9+ "px";
        /*    */ //(!d) ? ((x = getPos(3) ? ((board[getPos(4)] = 3) ? board[x] = 4 : 0) : 0;
        /* 10 */ if (d == 82) {
          //reset on "r"
          /* 11 */ for (var i = 0; i < reset.length; board[i] = reset[i++]) {
            /*    */
          }
          /*    */
        } else if (d == 999) {
        /* 12 */
          // swwap This could be small I *think*
          /* 13 */ var x = getPos(3);
          /* 14 */ board[getPos(4)] = 3;
          /* 15 */ board[x] = 4;
          /*    */
        } else if (d) {
        /* 16 */
          /* 17 */ for (
            var i = getPos(3);
            board[i + d] != 0 && board[i + d] != 4;
            board[(i += d)] = 3
          ) {
            /* 18 */ board[i] = 1;
            /*    */
          }
          /* 19 */ moves++; // introduces a bug - if you move INTO a wall (and you are already there), it increments move counter...
          /*    */
        }
        /*    */
      }
      /*    */ document.onkeyup = function (evt) {
        /* 20 */ doHit(
          { 82: 82, 32: 999, 37: -1, 38: -1 * width, 39: 1, 40: width }[
            (evt ? evt : event).keyCode
          ],
        )
          ? draw()
          : draw();
        /*    */
      };
    </script>
    This is inspired by (*cough*stolen from*cough*):
    <a href="http://oos.moxiecode.com/examples/d_star/index.html"
      >d-star by Outside of Society</a
    ><br />
    Which is based off of:
    <a href="http://joewing.calc.org/code/asm/dos/index.shtml"
      >d-star by Joe Wingbermuehle - ASM for dos</a
    ><br />
    <!--<a href="#" onClick="level++; draw(); return(false);">Next</a>-->
  </body>
</html>
